# AfricanFalls-walkthrough

## Challenge Link
https://cyberdefenders.org/blueteam-ctf-challenges/africanfalls

## Tools
* **FTK Imager**
* **Autopsy**
* **Mimikatz**

---

## Integrity Verification
Before working on the disk image, I checked its checksum and verified if it matched the value provided in the official case documentation. From the `DiskDigger.ad1.txt` file, I read that the MD5 checksum was: **9471e69c95d8909ae60ddff30d50ffa1** [Q1]. It matched the official reference checksum.

![md5checksum](https://github.com/user-attachments/assets/c4837fb7-e686-4028-927e-128b1bd31277)

---

## Environment Setup
To make the disk image accessible for analytical tools like Autopsy, I mounted the `DiskDigger.ad1` image file as a virtual drive in the operating system. **FTK Imager** was the ideal tool for this task. After launching the tool, I added the image to be mounted and selected the **"File System / Read Only"** method to ensure the evidence remained intact:

<img width="1357" height="837" alt="image" src="https://github.com/user-attachments/assets/2612413a-3a7a-4eb7-b04b-22777e938970" />

---

## Disk Analysis Using Autopsy
After properly mounting the image, I proceeded to the actual analysis. I launched Autopsy and selected the **"New Case"** option, pointing to my newly mounted drive. Next, in the **"Select Data Source"** tab, I chose **"Local files and folders"** and checked all *timestamps* to be included:

<img width="852" height="542" alt="image" src="https://github.com/user-attachments/assets/c3ae9449-48ec-42e8-b72e-90c2fb987eab" />

During configuration, I selected all **"Ingest Modules"** so that Autopsy could perform a full correlation of artifacts. Once the data processing was complete, I began examining the evidence.

### Basic System Information
First, I looked at the system and device owner information. From the **"Operating System Information"** section, I learned that the device name was `DESKTOP-0JS8C2`, and the installed OS was Windows 10 Home. The owner was **John Doe**:

![os_info](https://github.com/user-attachments/assets/b1750c27-d566-41aa-a235-9f293579180b)

In the **"OS Accounts"** tab, I found the account creation date: **April 25, 2021, 19:57:17 CEST**. The first significant clue was also visible here: John Doe set the same answer for every security question: **Roger**. This indicated a very low level of care regarding account security:

![os_accounts](https://github.com/user-attachments/assets/14bb07e1-e6fc-4ba1-82c9-9c86e1890184)

### Network Activity
My examination of the browsing history revealed that the user had been searching for information related to password cracking (phrase: `password cracking list` [Q2], time: **20:17:38 CEST**). In the **"Web History"** tab, I also found the ProtonMail email address the suspect logged into: `dreammaker82@protonmail.com` [Q6]:

![email_address](https://github.com/user-attachments/assets/2e3da1df-eb32-4346-ad02-8bb3ce79b1a9)

My analysis of **Prefetch** files in the **"Run Programs"** section showed the execution of the **Tor Browser** installer at **20:22:32 CEST**. This time closely coincided with the search for password cracking information. However, I noted that John Doe never launched the Tor browser itself, as no activity from the `tor.exe` process was recorded [Q5]:

![tor_activity](https://github.com/user-attachments/assets/e4831123-78d9-43b3-a7f1-c94c1295196a)

### File and Console Analysis
In the **"File Views"** section, I filtered files by extension or MIME type. In the text files, I found `ConsoleHost_history.txt` â€“ a document storing the history of commands executed in the console. Visible there was the `sdelete` command (used for secure data deletion) and `nmap dfir.science` [Q7], which confirmed that the user had scanned the mentioned domain:

![nmap](https://github.com/user-attachments/assets/f9b3144a-42cc-4d2e-a477-21a48e86f802)

Navigating to **"By MIME Type" -> "text" -> "xml"**, I located the `recentservers.xml` file generated by the **FileZilla** tool. From it, I read the IP address (`192.168.1.20` [Q3]) that the user connected to on port 21 (FTP) using the username **'kali'**:

![ip_address](https://github.com/user-attachments/assets/46f19055-6c68-4183-b1cb-3350b677dc6f)

### System Recycle Bin
Checking the contents of the recycle bin allowed me to find files the suspect tried to get rid of. I found a file containing a list of passwords for *brute-force* attacks. The user deleted it on **April 29, 2021, at 20:22:17 CEST** (18:22:17 UTC [Q4]):

![password_list](https://github.com/user-attachments/assets/ae49aaec-5d49-493c-8e73-906a03196f01)

### Multimedia and Geolocation
In the **"Images"** tab (under the **"By Extensions"** section), I found the photo `20210429_152043.jpg`. The EXIF metadata contained geographical coordinates (**16 S and 23 E**) and the exact time the photo was taken: **April 29, 2021, 17:20:43 CEST**. I also identified the device model: **LG-Q725K**:

![20210429_151535](https://github.com/user-attachments/assets/5ad32d0e-73f9-4b4a-8588-fae6670a470d)

Entering the coordinates into a map service pointed to the country of **Zambia** [Q8].

<img width="945" height="465" alt="image" src="https://github.com/user-attachments/assets/fbd98af3-c938-401d-a81b-48fcf1e847df" />

I used the mobile device information to determine the file transfer path. My analysis of **Shell Bags** artifacts in the registry revealed the folder from which the user copied photos to the computer: `\Camera` [Q9]:

![Camera_dict](https://github.com/user-attachments/assets/1d8b9e89-7804-46ab-8ffc-82f3e8c8b140)

---

## Password Recovery
Using the **Mimikatz** tool, I exported hashes for local accounts from the SAM and SYSTEM registry files. The NTLM hash of the user John Doe, after verification on the *hashes.com* website, turned out to correspond to a simple password: **ctf2021** [Q11]:

<img width="1346" height="772" alt="image" src="https://github.com/user-attachments/assets/611ce97b-65c4-4710-8cff-cfe40ff8898f" />

The same service allowed me to crack the Anon user's password, which was also trivial: **AFR1CA!** [Q10]:

<img width="639" height="330" alt="image" src="https://github.com/user-attachments/assets/d50c4dd3-6e1c-46e5-b2b4-447e13c421eb" />
